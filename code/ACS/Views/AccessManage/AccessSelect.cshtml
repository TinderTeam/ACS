<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>新增门禁权限</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <link href="../../script/demo.css" rel="stylesheet" type="text/css" />
    <script src="../../scripts/boot.js" type="text/javascript"></script>
</head>
<body>
<style type="text/css">
    html, body{
        margin:10px;padding:0;border:0;width:100%;height:100%;overflow:hidden;
    }    
</style>
    <h1>新增门禁权限</h1>  
        <form id="accessForm" method="post">
            
<div class="mini-fit" >
    <div id ="datagrid1" class="mini-datagrid" style="width:100%;height:100%;" allowResize="true"
        url="../AccessManage/UnSelectList"  idField="UserID" multiSelect="true">
        <div property="columns">
            <!--<div type="indexcolumn"></div>        -->
            <div type="checkcolumn" ></div>                  
            <div field="UserID" width="120" headerAlign="center" allowSort="true">用户系统ID</div>    
            <div field="UserName" width="120" headerAlign="center" allowSort="true">用户名</div>    
            <div field="UserDesc" width="120" headerAlign="center" allowSort="true">用户描述</div>
            <div header="日志">
                <div property="columns">
                    <div field="CreateUserID" width="120" headerAlign="center" allowSort="true">创建者ID</div>   
                    <div field="CreateDate" width="120" headerAlign="center" allowSort="true">创建时间</div>
                    <div field="CodifyUserID" width="120" headerAlign="center" allowSort="true">最后编辑者ID</div>
                    <div field="CodifyDate" width="120" headerAlign="center" allowSort="true">最后编辑时间</div> 
                </div>
            </div>                            
        </div>
    </div>
     <div style="text-align:center;padding:5px;">               
        <a class="mini-button" onclick="onOk" style="width:60px;margin-right:20px;">确定</a>              
     </div>
</div>    
</form>
    <script type="text/javascript">
        mini.parse();

        var form = new mini.Form("#accessForm");

        function SaveData() {
            var o = form.getData();
            form.validate();
            if (form.isValid() == false) return;

           
            url = "/AccessManage/select?doorid=@ViewBag.ID";
            var json = mini.encode(o);
            $.ajax({
                url: url,
                type: 'post',
                data: { data: json },
                cache: false,
                success: function (text) {说

                    if (text == "Success") {
                        mini.alert("修改成功！");
                        CloseWindow("save");
                    }
                    else {
                        alert(text);
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(jqXHR.responseText);
                    CloseWindow();
                }
            });
    }
    function GetData() {
        var o = form.getData();
        return o;
    }
    function CloseWindow(action) {
        if (action == "close" && form.isChanged()) {
            if (confirm("数据被修改了，是否先保存？")) {
                return false;
            }
        }
        if (window.CloseOwnerWindow) return window.CloseOwnerWindow(action);
        else window.close();
    }
    function onOk(e) {
        SaveData();
    }
    function onCancel(e) {
        CloseWindow("cancel");
    }
    </script>
</body>
</html>