<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>员工管理</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <link href="../../Scripts/demo.css" rel="stylesheet" type="text/css" />
    <script src="../../Scripts/boot.js" type="text/javascript"></script>
</head>
<body>
<style type="text/css">
    html, body{
        margin:0;padding:0;border:0;width:100%;height:100%;overflow:hidden;
    }
        
</style>
    <h1>事件类型管理</h1>
    <div class="mini-toolbar" style="border-bottom:0;padding:0px;">
            <table style="width:100%;">
                <tr>
                    <td style="width:100%;">
                        <a class="mini-button" iconCls="icon-edit" onclick="onModifyRow('Modify')">编辑</a>     
                    </td>
                </tr>
            </table>           
        </div>
<div class="mini-fit" >
    <div id ="datagrid1" class="mini-datagrid" style="width:100%;height:100%;" allowResize="true"
        url="Load"  idField="EventTypeID" multiSelect="true">
        <div property="columns">
            <div type="checkcolumn" ></div>                  
            <div field="EventTypeID" width="70" headerAlign="center" allowSort="true">事件类型ID</div>    
            <div field="EventTypeName" width="70" headerAlign="center" allowSort="true" align="center">事件类型名称</div> 
            <div field="ForegroundColor" width="70" headerAlign="center" allowSort="true" align="center">前景色</div>    
            <div field="BackgroundColor" width="70" headerAlign="center" allowSort="true" align="center">背景色</div>     
            <div field="Level" width="70" headerAlign="center" allowSort="true" align="center">事件级别</div>   
            <div field="Visible" width="70" headerAlign="center" allowSort="true" align="center" renderer="onYesRenderer">可见</div>
            <div field="Affirm" width="70" headerAlign="center" allowSort="true" align="center" renderer="onYesRenderer">是否需要确认</div>
            <div field="Alarm" width="70" headerAlign="center" allowSort="true" align="center" renderer="onYesRenderer">是否报警</div> 
              
                           
        </div>
    </div> 
</div>
    <script type="text/javascript">
        mini.parse();
        var grid = mini.get("#datagrid1");
        grid.load();
        //grid.sortBy("createtime", "desc");
        grid.on("drawcell", function (e) {
            var sender = e.sender;
            var record = e.record;
            var column = e.column;
            var field = e.field;
            var value = e.value;
            //给帐号列，增加背景色
            if ((field == "BackgroundColor") || (field == "ForegroundColor")) {
                e.cellStyle = "background:" + value;
            }

        });
        //新增、编辑窗口页面
        function onModifyRow(type) {
            var rows = grid.getSelecteds();
            var row = grid.getSelected();
            if (rows.length != 1)
            {
                mini.alert("请选择一条记录");
                return;
            }
            mini.open({
                url: "../EventTypeManage/ShowPage",
                title: "编辑事件类型", width: 350, height: 350,
                onload: function () {
                    var iframe = this.getIFrameEl();
                    var data = { id: row.EventTypeID };
                    iframe.contentWindow.Show(data);
                },
                ondestroy: function (action) {
                    grid.reload();
                }
            });

        }
    </script>
</body>
</html>